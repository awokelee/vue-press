(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{251:function(t,s,a){"use strict";a.r(s);var e=a(0),v=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"vue-项目-nginx-显示-404"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-项目-nginx-显示-404","aria-hidden":"true"}},[t._v("#")]),t._v(" Vue 项目 Nginx 显示 404")]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("404")]),a("p",[t._v("路由设置 "),a("code",[t._v("history")]),t._v(" 模式在 "),a("code",[t._v("nginx")]),t._v(" 下 "),a("code",[t._v("404")]),t._v(", 或者刷新才出现 "),a("code",[t._v("404")])])]),a("h2",{attrs:{id:"出现的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#出现的问题","aria-hidden":"true"}},[t._v("#")]),t._v(" 出现的问题")]),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),a("p",[t._v("如果直接访问项目出现 404, 则去检查是否少了项目前缀, 本文都是在项目主页可以正常访问情境下")])]),a("ul",[a("li",[a("p",[t._v("访问 "),a("code",[t._v("http://001.smj123dev.com/newsDetails/2/5")]),t._v(" 出现 "),a("code",[t._v("404 Not Found")])])]),a("li",[a("p",[t._v("刷新当前页面变成 "),a("code",[t._v("404 Not Found")])])])]),a("h2",{attrs:{id:"解决方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 解决方法")]),a("h3",{attrs:{id:"前端来处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端来处理","aria-hidden":"true"}},[t._v("#")]),t._v(" 前端来处理")]),a("ul",[a("li",[t._v("步骤一")])]),a("p",[t._v("在 "),a("code",[t._v("src/router/index.js")]),t._v(" 文件中, 将 "),a("code",[t._v("mode: 'history'")]),t._v(" 改成 "),a("code",[t._v("mode: 'hash'")]),t._v(", 即改成哈希模式.")]),a("ul",[a("li",[t._v("步骤二")])]),a("p",[t._v("如果项目中有使用 "),a("code",[t._v("window.open")]),t._v(", 则将所有 "),a("code",[t._v(".vue")]),t._v(" 文件中的 "),a("code",[t._v("window.open")]),t._v(" (会新开窗口)路径前面加上 "),a("code",[t._v("#")]),t._v("(变成 "),a("code",[t._v("hash")]),t._v(" 模式)")]),a("p",[t._v("例如:")]),a("p",[t._v("开始的代码:")]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" path "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'/newsDetails/1/'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" id\nwindow"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("open")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("更改后")]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" path "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'#/newsDetails/1/'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" id\nwindow"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("open")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"后台来处理-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后台来处理-nginx","aria-hidden":"true"}},[t._v("#")]),t._v(" 后台来处理, nginx")]),a("ul",[a("li",[t._v("思路: 把所有请求转到 "),a("code",[t._v("index.html")])])]),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("location / "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  try_files "),a("span",{attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因","aria-hidden":"true"}},[t._v("#")]),t._v(" 原因")]),a("ul",[a("li",[a("p",[t._v("当访问 "),a("code",[t._v("http://001.smj123dev.com/newsDetails/2/5")]),t._v(" 出现 "),a("code",[t._v("404")]),t._v(", 是因为在 "),a("code",[t._v("nginx")]),t._v(" 配置的根目录下面没有 "),a("code",[t._v("/newsDetails/2/5")]),t._v(" 这个真实资源存在，这些访问资源都是在"),a("code",[t._v("js")]),t._v("里渲染的.")])]),a("li",[a("p",[a("code",[t._v("vue-router")]),t._v(" 默认 "),a("code",[t._v("hash")]),t._v(" 模式 —— 使用 "),a("code",[t._v("URL")]),t._v(" 的 "),a("code",[t._v("hash")]),t._v(" 来模拟一个完整的 "),a("code",[t._v("URL")]),t._v("，于是当 "),a("code",[t._v("URL")]),t._v(" 改变时，"),a("code",[t._v("页面不会重新加载")])])]),a("li",[a("p",[a("code",[t._v("history")]),t._v(" 模式，利用 "),a("code",[t._v("history.pushState")]),a("code",[t._v("API")]),t._v(" 来完成 "),a("code",[t._v("URL")]),t._v(" 跳转, 也就是动态的通过 "),a("code",[t._v("js")]),t._v(" 操作 "),a("code",[t._v("window.history")]),t._v(" 来改变浏览器地址栏里的路径，并没有发起 "),a("code",[t._v("http")]),t._v(" 请求，但是当直接在浏览器里输入这个地址("),a("code",[t._v("刷新")]),t._v(")的时候，就一定要对服务器发起 "),a("code",[t._v("http")]),t._v(" 请求，但是这个目标在服务器上又不存在，所以会返回 "),a("code",[t._v("404")])])])]),a("h2",{attrs:{id:"地址栏展示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#地址栏展示","aria-hidden":"true"}},[t._v("#")]),t._v(" 地址栏展示")]),a("p",[t._v("最直观的就是地址栏多了个 "),a("code",[t._v("#")])]),a("ul",[a("li",[a("p",[a("code",[t._v("history")]),t._v(" 模式在地址栏展示为: "),a("code",[t._v("http://001.smj123dev.com/newsDetails/2/5")])])]),a("li",[a("p",[a("code",[t._v("hash")]),t._v(" 模式在地址栏展示为: "),a("code",[t._v("http://001.smj123dev.com/#/newsDetails/2/5")])])])])])}],!1,null,null,null);s.default=v.exports}}]);